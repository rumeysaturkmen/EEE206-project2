#include <stdio.h>
#include <stdlib.h>
#include <string.h>
struct student{
	char number[50];
	char password[50];
	char answer[50];
};
int main(){
	int i,j,menu,yes=0,no=0;
	char user[50],pass[50];
	FILE *fp,*fp2;
	fp = fopen("dosya.txt","r"); 
	fp2 = fopen("dosya2.txt","w");
	struct student s[3];
	for(i=0;i<3;i++){
		fscanf(fp,"%s %s %s",&s[i].number,&s[i].password,&s[i].answer);
	}
	fclose(fp);	
	while(1){
		printf("1.Vote\n2.Change Vote\n3.Change Password\n4.Exit\nSelect Menu[1/2/3/4]: ");scanf("%d",&menu);
		switch(menu){
			case 1:
				printf("\nUsername : ");scanf("%s",&user);
				i=0;
				while(strcmp(user,s[i].number)!=0&&i<3){
					i++;
				}
				if(i==3){
					printf("User Not Found!\n\n");
				}
				else{
					printf("Password : ");scanf("%s",&pass);
					while(strcmp(pass,s[i].password)!=0){
						printf("Wrong Password! Try again : ");scanf("%s",&pass);
					}
					if(strcmp("-",s[i].answer)==0){
						printf("Are you happy [yes/no] : ");scanf("%s",&s[i].answer);
						printf("\n");
					}
					else{
						printf("You have already anwered!\n\n");
					}
				}
				break;
			case 2:
				printf("\nUsername : ");scanf("%s",&user);
				i=0;
				while(strcmp(user,s[i].number)!=0&&i<3){
					i++;
				}
				if(i==3){
					printf("User Not Found!\n\n");
				}
				else{
					printf("Password : ");scanf("%s",&pass);
					while(strcmp(pass,s[i].password)!=0){
						printf("Wrong Password! Try again : ");scanf("%s",&pass);
					}
					if(strcmp("-",s[j].answer)==0){
						printf("You are voting first time! Are you happy [yes/no]: ");scanf("%s",&s[i].answer);
						printf("\n");
					}
					else{
						printf("Are you happy [yes/no] : ");scanf("%s",&s[i].answer);
						printf("\n");
					}
				}
				break;
			case 3:
				printf("\nUsername : ");scanf("%s",&user);
				i=0;
				while(strcmp(user,s[i].number)!=0&&i<3){
					i++;
				}
				if(i==3){
					printf("User Not Found!\n\n");
				}
				else{
					printf("Password : ");scanf("%s",&pass);
					while(strcmp(pass,s[i].password)!=0){
						printf("Wrong Password! Try again : ");scanf("%s",&pass);
					}
					printf("New Password : ");scanf("%s",&s[i].password);
				}
				break;
			case 4:
				for(i=0;i<3;i++){
					if(strcmp("yes",s[i].answer)==0){
						yes++;
					}
					else if(strcmp("no",s[i].answer)==0){
						no++;
					}
					fprintf(fp2,"%s %s %s\n",s[i].number,s[i].password,s[i].answer);
				}
				fclose(fp2);
				remove("dosya.txt");
				rename("dosya2.txt","dosya.txt");
				printf("\n\nYes:%d\nNo:%d",yes,no);
				return 0;
			default:
				printf("Invalid input!\n\n");
		}
	}	
	return 0;
}
